// src/js/data/properties.js
export const properties = [
  {
    id: 1,
    name: "M Terra",
    developer: "Mah Sing Group Berhad",
    location: "Puchong, Selangor",
    tagline: "Affordable luxury in Puchong",
    price: 384000,
    monthlyRent: null,
    type: "Service Residence",
    category: "new",
    listingType: "sale",
    projectStage: "New launch",
    tenure: "Leasehold",
    bedrooms: "2-3",
    bathrooms: "2",
    size: "775-1023",
    monthlyRepayment: 1649,
    completionDate: 2028,
    description: "M Terra in Puchong offers affordable luxury living with modern amenities and excellent connectivity.",
    preview: "/images/properties/M-Terra/previews/condo-preview.jpg",
    features: [
      "Strategic location",
      "Modern design",
      "Security system",
      "Quality finishes"
    ],
    facilities: [
      {
        id: "fac-1",
        name: "Overview",
        image: "/images/properties/M-Terra/facilities/overview.jpg",
        description: "Property Overview"
      },
      {
        id: "fac-2",
        name: "Swimming Pool",
        image: "/images/properties/M-Terra/facilities/swimming-pool.jpg",
        description: "Luxury swimming pool for residents"
      }
    ],
    floorPlans: [
      {
        id: "fp-2",
        type: "Type B",
        size: "850 sqft",
        bedrooms: 3,
        bathrooms: 2,
        image: "/images/properties/M-Terra/floor-plans/type-b.png"
      },
      {
        id: "fp-3",
        type: "Type C",
        size: "1023 sqft",
        bedrooms: 3,
        bathrooms: 2,
        image: "/images/properties/M-Terra/floor-plans/type-c.png"
      }
    ],
    interior: [
      {
        id: "int-1",
        name: "Bathroom",
        image: "/images/properties/M-Terra/interior/bathroom.png",
        description: "Modern bathroom design"
      },
      {
        id: "int-2",
        name: "Kitchen",
        image: "/images/properties/M-Terra/interior/kitchen.png",
        description: "Spacious kitchen layout"
      },
      {
        id: "int-3",
        name: "Living Room",
        image: "/images/properties/M-Terra/interior/livingroom.png",
        description: "Contemporary living space"
      },
      {
        id: "int-4",
        name: "Master Room",
        image: "/images/properties/M-Terra/interior/masterroom.png",
        description: "Comfortable master bedroom"
      },
      {
        id: "int-5",
        name: "Second Room",
        image: "/images/properties/M-Terra/interior/secondroom.png",
        description: "Cozy second bedroom"
      }
    ],
    location: {
      image: "/images/properties/M-Terra/location/location.jpg",
      description: "Strategic location in Puchong"
    },
    additionalInfo: {
      totalUnits: 999,
      listingId: "39715937",
      propertyType: "Service Residence For Sale"
    }
  },
  {
    id: 2,
    name: "Sanderling Lakefront",
    developer: "MCT Berhad",
    location: "Cyberjaya, Selangor",
    tagline: "Mystery Packages New Launch Promotion, RM500 to Own, Free Furniture",
    price: 450000,
    monthlyRent: null,
    type: "Condominium",
    category: "new",
    listingType: "sale",
    projectStage: "New launch",
    tenure: "Freehold",
    bedrooms: "3-4",
    bathrooms: "2",
    size: "958-1324",
    monthlyRepayment: 2020,
    completionDate: 2025,
    description: "Sanderling Lakefront in Cyberjaya offers spacious units with modern amenities, excellent connectivity, and a promotional package for early buyers.",
    preview: "/images/properties/Sanderling/previews/condo-preview.jpg",
    features: [
      "RM500 Booking Fee Only",
      "Free S&P Legal & Loan Agreement Fees",
      "Free 2 Car Park",
      "Free Kitchen Cabinet"
    ],
    facilities: [
      {
        id: "fac-1",
        name: "Gym",
        image: "/images/properties/Sanderling/facilities/gym.jpg",
        description: "Modern gymnasium equipped with latest fitness equipment"
      },
      {
        id: "fac-2",
        name: "Jogging Track",
        image: "/images/properties/Sanderling/facilities/jogging-track.jpg",
        description: "Dedicated jogging track for residents"
      },
      {
        id: "fac-3",
        name: "Maze Garden",
        image: "/images/properties/Sanderling/facilities/maze-garden.jpg",
        description: "Beautiful maze garden for relaxation"
      },
      {
        id: "fac-4",
        name: "Sky Swimming Pool",
        image: "/images/properties/Sanderling/facilities/sky-swimming-pool.jpeg",
        description: "Luxurious sky pool with panoramic views"
      }
    ],
    floorPlans: [
      {
        id: "fp-1",
        type: "Type A",
        size: "958 sqft",
        bedrooms: 3,
        bathrooms: 2,
        image: "/images/properties/Sanderling/floor-plans/type-a.png"
      },
      {
        id: "fp-2",
        type: "Type B",
        size: "1711 sqft",
        bedrooms: 4,
        bathrooms: 2,
        image: "/images/properties/Sanderling/floor-plans/type-b.jpg"
      }
    ],
    interior: [
      {
        id: "int-1",
        name: "Balcony",
        image: "/images/properties/Sanderling/interior/balcony.jpg",
        description: "Spacious balcony with scenic views"
      },
      {
        id: "int-2",
        name: "Kitchen Area",
        image: "/images/properties/Sanderling/interior/kitchen-area.jpg",
        description: "Modern kitchen with premium finishes"
      },
      {
        id: "int-3",
        name: "Living Room",
        image: "/images/properties/Sanderling/interior/living-room.jpeg",
        description: "Contemporary living space design"
      },
      {
        id: "int-4",
        name: "Master Studio Room",
        image: "/images/properties/Sanderling/interior/master-studio-room.jpg",
        description: "Luxurious master bedroom"
      },
      {
        id: "int-5",
        name: "Second Room",
        image: "/images/properties/Sanderling/interior/second-room.jpg",
        description: "Comfortable second bedroom"
      },
      {
        id: "int-6",
        name: "Small Room",
        image: "/images/properties/Sanderling/interior/small-room.jpg",
        description: "Cozy small bedroom"
      }
    ],
    location: {
      image: "/images/properties/Sanderling/location/location.png",
      description: "Strategic location in Cyberjaya"
    },
    additionalInfo: {
      totalUnits: 606,
      listingId: "42475775",
      propertyType: "Condominium For Sale"
    }
  },
  {
    id: 3,
    name: "Grand Damansara",
    developer: "Grand Global",
    location: "Jalan Anggerik, Off Lebuhraya Sprint, 47400 Petaling Jaya, Selangor",
    tagline: "Lifestyle Suites & Serviced Apartments in Petaling Jaya",
    price: 243000,
    monthlyRent: null,
    type: "Serviced Apartment",
    category: "new",
    listingType: "sale",
    projectStage: "New launch",
    tenure: "Leasehold", 
    bedrooms: "Studio to 3",
    bathrooms: "1 - 2",
    size: "273 - 936",
    monthlyRepayment: 1043, // 基于价格243000计算的大约月供
    completionDate: 2027,
    description: "Grand Damansara is a new high-rise development comprising two blocks of lifestyle suites and serviced apartments with retail units on its ground and first floor.",
    preview: "/images/properties/Grand-Damansara/previews/previews.jpg",
    features: [
        "Excellent connectivity to LRT stations",
        "Proximity to major highways", 
        "4-tier security system",
        "Retail units on ground floor"
    ],
    facilities: [
        {
            id: "fac-1",
            name: "Hammock Garden",
            image: "/images/properties/Grand-Damansara/facilities/hammock.webp",
            description: "Relaxing hammock garden area for residents"
        },
        {
            id: "fac-2", 
            name: "Jacuzzi Pool",
            image: "/images/properties/Grand-Damansara/facilities/jacuzzi.webp",
            description: "Luxury jacuzzi pool for relaxation"
        },
        {
            id: "fac-3",
            name: "Swimming Pool",
            image: "/images/properties/Grand-Damansara/facilities/overall-swimming-pool.webp",
            description: "Grand swimming pool with city view"
        },
        {
            id: "fac-4",
            name: "Resort Facilities",
            image: "/images/properties/Grand-Damansara/facilities/resort-facilities-design.jpg", 
            description: "Resort-style facilities for residents"
        }
    ],
    floorPlans: [
        {
            id: "fp-1",
            type: "Type A",
            size: "273 sqft",
            bedrooms: "Studio",
            bathrooms: "1",
            image: "/images/properties/Grand-Damansara/floor-plans/type-a-273sf.jpg"
        },
        {
            id: "fp-2", 
            type: "Type B (Dual Key)",
            size: "469 sqft",
            bedrooms: "1+1",
            bathrooms: "2",
            image: "/images/properties/Grand-Damansara/floor-plans/type-b-469sf-dualkey.png"
        },
        {
            id: "fp-3",
            type: "Type C",
            size: "471 sqft", 
            bedrooms: "1",
            bathrooms: "1",
            image: "/images/properties/Grand-Damansara/floor-plans/type-c-471sf.jpg"
        },
        {
            id: "fp-4",
            type: "Type D",
            size: "686 sqft",
            bedrooms: "2",
            bathrooms: "2",
            image: "/images/properties/Grand-Damansara/floor-plans/type-d-686sf.webp"
        },
        {
            id: "fp-5",
            type: "Type E",
            size: "916 sqft",
            bedrooms: "3",
            bathrooms: "2",
            image: "/images/properties/Grand-Damansara/floor-plans/type-e-916sf.webp"
        }
    ],
    interior: [
        {
            id: "int-1",
            name: "Living Room",
            image: "/images/properties/Grand-Damansara/interior/living-room.jpg",
            description: "Spacious and modern living room design"
        },
        {
            id: "int-2",
            name: "Studio with Bathroom",
            image: "/images/properties/Grand-Damansara/interior/studio-with-bathroom.jpg",
            description: "Efficient studio layout with attached bathroom"
        },
        {
            id: "int-3",
            name: "Studio Unit",
            image: "/images/properties/Grand-Damansara/interior/studio.jpg",
            description: "Contemporary studio unit design"
        }
    ],
    location: {
        image: "/images/properties/Grand-Damansara/location/location.png",
        description: "Strategic location in Petaling Jaya"
    },
    locationHighlight: {
        image: "/images/properties/Grand-Damansara/location/walkable-500m-to-lrt.jpg",
        description: "Just 500m walking distance to LRT station"
    },
    additionalInfo: {
        totalUnits: 981,
        listingId: "GD2023PJ",
        propertyType: "Mix Development"
    }
  },
  {
    id: 4,
    name: "Skyline Embassy",
    developer: "TsLaw Group",
    location: "Jalan Ampang, 55000, Kuala Lumpur",
    tagline: "An Iconic Address in the Heart of Kuala Lumpur",
    price: 680000,
    monthlyRent: null,
    type: "Serviced Apartment",
    category: "new",
    listingType: "sale",
    projectStage: "New launch",
    tenure: "Freehold",
    bedrooms: "1 to 3",
    bathrooms: "1 - 2",
    size: "551 - 1,005",
    monthlyRepayment: 2920, // 基于价格680000计算的大约月供
    completionDate: 2028,
    description: "Skyline Embassy is an exclusive residential enclave that redefines luxury living along Kuala Lumpur's prestigious Embassy Row, featuring three magnificent towers with meticulously crafted units and world-class facilities.",
    preview: "/images/properties/Skyline-Embassy/previews/preview.jpg",
    features: [
        "Prime location near embassies and major landmarks",
        "High ceilings and spacious layouts",
        "Infinity pool with panoramic city views",
        "24-hour security and concierge services"
    ],
    facilities: [
        {
            id: "fac-1",
            name: "Project Overview",
            image: "/images/properties/Skyline-Embassy/facilities/overview.png",
            description: "Overall development perspective"
        },
        {
            id: "fac-2",
            name: "Rooftop Swimming Pool",
            image: "/images/properties/Skyline-Embassy/facilities/rooftop-swimming-pool.jpg",
            description: "Infinity pool with panoramic city views"
        },
        {
            id: "fac-3",
            name: "Sky Dining",
            image: "/images/properties/Skyline-Embassy/facilities/sky-dinning.jpg",
            description: "Exclusive sky dining area for residents"
        },
        {
            id: "fac-4",
            name: "Theater Room",
            image: "/images/properties/Skyline-Embassy/facilities/theater-room.jpg",
            description: "Private theater room for residents"
        }
    ],
    floorPlans: [
        {
            id: "fp-1",
            type: "Type A",
            size: "551 sqft",
            bedrooms: 1,
            bathrooms: 1,
            image: "/images/properties/Skyline-Embassy/floor-plans/type-a-551sf.png"
        },
        {
            id: "fp-2",
            type: "Type B",
            size: "710 sqft",
            bedrooms: 2,
            bathrooms: 2,
            image: "/images/properties/Skyline-Embassy/floor-plans/type-b-710sf.png"
        },
        {
            id: "fp-3",
            type: "Type C (Dual Key)",
            size: "841 sqft",
            bedrooms: "2+1",
            bathrooms: 2,
            image: "/images/properties/Skyline-Embassy/floor-plans/type-c-841sf-dualkey.png"
        },
        {
            id: "fp-4",
            type: "Type D",
            size: "853 sqft",
            bedrooms: 3,
            bathrooms: 2,
            image: "/images/properties/Skyline-Embassy/floor-plans/type-d-853sf.png"
        },
        {
            id: "fp-5",
            type: "Type E",
            size: "1005 sqft",
            bedrooms: 3,
            bathrooms: 2,
            image: "/images/properties/Skyline-Embassy/floor-plans/type-e-1005sf.png"
        }
    ],
    interior: [
        {
            id: "int-1",
            name: "Dual Key Studio",
            image: "/images/properties/Skyline-Embassy/interior/dual-key-studio.png",
            description: "Efficient dual key studio layout"
        },
        {
            id: "int-2",
            name: "Living Room",
            image: "/images/properties/Skyline-Embassy/interior/living-room.png",
            description: "Spacious living room with modern design"
        },
        {
            id: "int-3",
            name: "Master Bathroom",
            image: "/images/properties/Skyline-Embassy/interior/master-bathroom.png",
            description: "Luxurious master bathroom"
        },
        {
            id: "int-4",
            name: "Master Room",
            image: "/images/properties/Skyline-Embassy/interior/master-room.png",
            description: "Elegant master bedroom"
        }
    ],
    location: {
        image: "/images/properties/Skyline-Embassy/location/location.jpg",
        description: "Prime location in Kuala Lumpur's Embassy Row"
    },
    additionalInfo: {
        totalUnits: 1296,
        listingId: "SE2023KL",
        propertyType: "Serviced Apartment"
    }
  },
  {
    id: 5,
    name: "M Azura",
    developer: "Mah Sing Group Berhad",
    location: "Setapak, Kuala Lumpur",
    tagline: "Affordable luxury in Setapak",
    price: 378000,
    monthlyRent: null,
    type: "Service Residence",
    category: "new",
    listingType: "sale",
    projectStage: "New launch",
    tenure: "Leasehold",
    bedrooms: "2-4",
    bathrooms: "2-3",
    size: "700-1000",
    monthlyRepayment: 1623, // 基于价格378000计算的大约月供
    completionDate: 2028,
    description: "M Azura offers a modern living experience with extensive amenities and excellent connectivity, designed for urban affordability.",
    preview: "/images/properties/M-Azura/previews/preview.jpg",
    
    features: [
        "Strategic Location",
        "Modern Design",
        "Security System",
        "Quality Finishes",
        "Green Features (GreenRE Silver Provisional Certification)"
    ],
    
    facilities: [
        {
            id: "fac-1",
            name: "Garden",
            image: "/images/properties/M-Azura/facilities/garden.jpg",
            description: "Landscaped garden for residents"
        },
        {
            id: "fac-2",
            name: "KL City View",
            image: "/images/properties/M-Azura/facilities/kl-city-view.jpg",
            description: "Breathtaking view of Kuala Lumpur city"
        },
        {
            id: "fac-3",
            name: "Overview",
            image: "/images/properties/M-Azura/facilities/overview.jpg",
            description: "Overall development perspective"
        },
        {
            id: "fac-4",
            name: "Swimming Pool",
            image: "/images/properties/M-Azura/facilities/swimming-pool.jpg",
            description: "Luxury swimming pool with city view"
        }
    ],
    
    floorPlans: [
        {
            id: "fp-1",
            type: "Type A",
            size: "700 sqft",
            bedrooms: 2,
            bathrooms: 2,
            image: "/images/properties/M-Azura/floor-plans/type-a-700sf.jpg"
        },
        {
            id: "fp-2",
            type: "Type B",
            size: "850 sqft",
            bedrooms: 3,
            bathrooms: 2,
            image: "/images/properties/M-Azura/floor-plans/type-b-850sf.jpg"
        },
        {
            id: "fp-3",
            type: "Type C",
            size: "1000 sqft",
            bedrooms: 4,
            bathrooms: 3,
            image: "/images/properties/M-Azura/floor-plans/type-c-1000sf.jpg"
        }
    ],
    
    interior: [ // 注意：这里修正了属性名从 interiorFeatures 到 interior
        {
            id: "int-1",
            name: "Dining Area",
            image: "/images/properties/M-Azura/interior/dinning.jpg",
            description: "Modern dining area design"
        },
        {
            id: "int-2",
            name: "Kitchen",
            image: "/images/properties/M-Azura/interior/kitchen.jpg",
            description: "Contemporary kitchen layout"
        },
        {
            id: "int-3",
            name: "Living Room",
            image: "/images/properties/M-Azura/interior/living.jpg",
            description: "Spacious living area"
        },
        {
            id: "int-4",
            name: "Master Bedroom",
            image: "/images/properties/M-Azura/interior/master-room.jpg",
            description: "Comfortable master bedroom"
        }
    ],
    
    location: { // 添加了 location 对象
        image: "/images/properties/M-Azura/location/location.png",
        description: "Strategic location in Setapak, Kuala Lumpur"
    },
    
    additionalInfo: {
        totalUnits: 1140,
        listingId: "39715938",
        propertyType: "Service Residence For Sale"
    },
    
    accessibilityDetails: {
        publicTransport: ["Sri Rampai LRT Station", "Wangsa Maju LRT Station"],
        highways: ["DUKE Highway", "MEX Highway"]
    }
  }
];

// 保持筛选函数不变
export const filterProperties = (properties, filters) => {
  const { listingType, propertyCategory, priceRange, propertyType, location } = filters;

  return properties.filter(property => {
    // 1. ListingType (Buy/Rent) 检查
    if (listingType === 'rent' && !property.monthlyRent) {
      return false;
    }
    if (property.listingType !== listingType) {
      return false;
    }

    // 2. New/Subsale 检查
    if (listingType === 'sale' && propertyCategory) {
      if (propertyCategory === 'new' && property.category !== 'new') return false;
      if (propertyCategory === 'subsale' && property.category === 'new') return false;
    }

    // 3. Property Type 检查
    if (propertyType && propertyType !== 'any') {
      switch (propertyType) {
        case 'condo':
          if (!['condominium', 'service residence'].includes(property.type.toLowerCase())) {
            return false;
          }
          break;
        case 'apartment':
          if (!['apartment', 'flat'].includes(property.type.toLowerCase())) {
            return false;
          }
          break;
        case 'terrace':
          if (property.type.toLowerCase() !== 'terrace house') {
            return false;
          }
          break;
        case 'semi-d':
          if (property.type.toLowerCase() !== 'semi-d') {
            return false;
          }
          break;
        case 'bungalow':
          if (property.type.toLowerCase() !== 'bungalow') {
            return false;
          }
          break;
      }
    }

    // 4. Location 检查
    if (location && location !== 'any') {
      const propertyLocation = (typeof property.location === 'string' 
        ? property.location 
        : property.location.description).toLowerCase();
      
      switch (location) {
        case 'selangor':
          if (!['selangor', 'puchong', 'cyberjaya', 'subang', 'petaling'].some(city => 
            propertyLocation.includes(city))) {
            return false;
          }
          break;
        case 'kl':
          if (!['kuala lumpur', 'kl'].some(city => propertyLocation.includes(city))) {
            return false;
          }
          break;
        default:
          if (!propertyLocation.includes(location)) {
            return false;
          }
      }
    }

    // 5. Price Range 检查
    if (priceRange && priceRange !== 'any') {
      if (listingType === 'rent') {
        const rent = property.monthlyRent;
        switch (priceRange) {
          case 'below-1000':
            return rent < 1000;
          case '1000-2000':
            return rent >= 1000 && rent <= 2000;
          case '2000-3000':
            return rent > 2000 && rent <= 3000;
          case '3000-5000':
            return rent > 3000 && rent <= 5000;
          case 'above-5000':
            return rent > 5000;
        }
      } else {
        const price = property.price;
        switch (priceRange) {
          case 'below-500k':
            return price < 500000;
          case '500k-1m':
            return price >= 500000 && price <= 1000000;
          case '1m-2m':
            return price > 1000000 && price <= 2000000;
          case 'above-2m':
            return price > 2000000;
        }
      }
    }

    return true;
  });
};